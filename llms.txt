# Primeira News - Next.js WordPress Frontend

Primeira News is a modern news portal built with Next.js 16.1.0-canary.14 and React 19.3.0-canary-fd524fe0-20251121, serving as a performant frontend for a WordPress-powered content management system. The application leverages Next.js App Router, Server Components, React Compiler (automatic memoization), and advanced caching strategies to deliver fast-loading news content with real-time updates via webhook integration.

The project implements a complete news aggregation platform featuring WordPress REST API integration, Twitter/X trending topics, YouTube video metadata fetching, and responsive image optimization with TwicPics. It uses TanStack Query for client-side data management, Embla Carousel for content sliders, and Motion (Framer Motion) for smooth animations. The architecture emphasizes performance with component-level caching (cacheComponents), React Compiler auto-memoization, ISR (Incremental Static Regeneration), and on-demand revalidation with advanced rate limiting and multi-tag support.

## API Endpoints

### GET /api/posts

Fetch paginated WordPress posts with optional category filtering.

```typescript
// Basic usage - fetch first 10 posts
const response = await fetch('/api/posts');
const posts = await response.json();

// Fetch specific number of posts
const response = await fetch('/api/posts?perPage=20&page=1');
const posts = await response.json();

// Fetch posts by category slug
const response = await fetch('/api/posts?categorySlug=noticias&perPage=15&page=1');
const categoryPosts = await response.json();

// Response structure
[
  {
    id: 12345,
    slug: "noticia-importante-hoje",
    title: { rendered: "Notícia Importante Hoje" },
    excerpt: { rendered: "<p>Resumo da notícia...</p>" },
    content: { rendered: "<p>Conteúdo completo...</p>" },
    date: "2025-12-04T10:30:00",
    featured_media: 67890,
    categories: [1, 5],
    categories_names: ["Notícias", "Política"],
    _embedded: {
      "wp:featuredmedia": [{
        source_url: "https://example.com/image.jpg",
        alt_text: "Image description"
      }]
    }
  }
]
```

### GET /api/posts/[slug]

Fetch a single WordPress post by its slug.

```typescript
// Fetch specific post
const response = await fetch('/api/posts/noticia-importante-hoje');
if (response.ok) {
  const post = await response.json();
  console.log(post.title.rendered);
} else if (response.status === 404) {
  console.log('Post not found');
}

// Response structure (single post object)
{
  id: 12345,
  slug: "noticia-importante-hoje",
  title: { rendered: "Notícia Importante Hoje" },
  content: { rendered: "<article>...</article>" },
  date: "2025-12-04T10:30:00",
  link: "https://primeiranews.com.br/2025/12/04/noticia-importante-hoje",
  categories_names: ["Notícias", "Brasil"],
  _embedded: {
    "wp:featuredmedia": [{
      source_url: "https://primeiranews.com.br/wp-content/uploads/2025/12/image.jpg"
    }],
    "author": [{
      id: 1,
      name: "Editor"
    }]
  }
}
```

### POST /api/revalidate

Webhook endpoint for on-demand cache revalidation triggered by WordPress updates. Features rate limiting (30 requests/minute per IP), multi-tag support, and comprehensive error handling.

```bash
# Revalidate posts list cache (single tag)
curl -X POST https://yoursite.vercel.app/api/revalidate \
  -H "Authorization: Bearer your-webhook-secret" \
  -H "Content-Type: application/json" \
  -d '{"tag":"posts-list"}'

# Revalidate multiple tags at once (batch revalidation)
curl -X POST https://yoursite.vercel.app/api/revalidate \
  -H "Authorization: Bearer your-webhook-secret" \
  -H "Content-Type: application/json" \
  -d '{"tags":["posts-list","post-noticia-importante","categories"]}'

# Revalidate specific post cache
curl -X POST https://yoursite.vercel.app/api/revalidate \
  -H "Authorization: Bearer your-webhook-secret" \
  -H "Content-Type: application/json" \
  -d '{"tag":"post-noticia-importante-hoje"}'

# Success response
{
  "success": true,
  "message": "3 tag(s) revalidada(s) com sucesso",
  "data": {
    "revalidated": ["posts-list", "post-noticia-importante", "categories"],
    "failed": [],
    "processingTimeMs": 124
  },
  "timestamp": "2025-12-05T15:30:45.123Z"
}

# Rate limit response (429 Too Many Requests)
{
  "error": "Too many requests. Try again later.",
  "retryAfter": 60
}

# Error response (401 Unauthorized)
{
  "error": "Unauthorized - Invalid or missing authorization token"
}
```

### GET /api/revalidate

Health check endpoint to verify webhook configuration status.

```bash
# Check if revalidation API is properly configured
curl https://yoursite.vercel.app/api/revalidate

# Response
{
  "status": "operational",
  "message": "Revalidation API is running",
  "endpoints": {
    "POST": {
      "description": "Revalidate cache for specific tag(s)",
      "authentication": "Authorization: Bearer YOUR_WEBHOOK_SECRET",
      "examples": {
        "singleTag": {
          "body": { "tag": "posts-list" }
        },
        "multipleTags": {
          "body": { "tags": ["posts-list", "post-seu-slug", "category-noticias"] }
        }
      }
    }
  },
  "timestamp": "2025-12-05T15:30:45.123Z"
}
```

### GET /api/twitter/trends

Fetch trending topics from Twitter/X for Brazil with fallback mechanisms.

```typescript
// Fetch Twitter trends
const response = await fetch('/api/twitter/trends');
const trends = await response.json();

// Response structure
[
  {
    tag: "#Brasil",
    tweets: "127K",
    url: "https://twitter.com/search?q=%23Brasil"
  },
  {
    tag: "Política",
    tweets: "89K",
    url: "https://twitter.com/search?q=Pol%C3%ADtica"
  },
  {
    tag: "#Economia",
    tweets: "56K",
    url: "https://twitter.com/search?q=%23Economia"
  }
]

// The endpoint tries multiple sources:
// 1. Twitter API (if TWITTER_BEARER_TOKEN is set)
// 2. GetDayTrends scraping (fallback)
// 3. Static fallback trends (if all fail)
```

### POST /api/youtube/metadata

Batch fetch YouTube video metadata for multiple video URLs.

```typescript
// Fetch metadata for multiple YouTube videos
const response = await fetch('/api/youtube/metadata', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    urls: [
      'https://www.youtube.com/watch?v=dQw4w9WgXcQ',
      'https://youtu.be/9bZkp7q19f0',
      'https://www.youtube.com/embed/jNQXAC9IVRw'
    ]
  })
});

const data = await response.json();

// Response structure
{
  items: {
    "dQw4w9WgXcQ": {
      videoId: "dQw4w9WgXcQ",
      title: "Rick Astley - Never Gonna Give You Up",
      thumbnail: "https://i.ytimg.com/vi/dQw4w9WgXcQ/maxresdefault.jpg",
      duration: "3:32",
      views: 1450000000,
      channelTitle: "Rick Astley"
    },
    "9bZkp7q19f0": {
      videoId: "9bZkp7q19f0",
      title: "Video Title",
      thumbnail: "https://i.ytimg.com/vi/9bZkp7q19f0/maxresdefault.jpg",
      duration: "12:45",
      views: 5200000,
      channelTitle: "Channel Name"
    }
  }
}

// Error response (missing API key)
{
  "error": "YOUTUBE_API_KEY não configurada no ambiente"
}
```

## Server-Side Data Fetching

### getPosts(perPage, page)

Server-only function to fetch WordPress posts with caching and revalidation tags.

```typescript
// app/page.tsx or any Server Component
import { getPosts } from '@/src/server/wordpress';

export default async function HomePage() {
  // Fetch 20 posts, first page
  const posts = await getPosts(20, 1);

  return (
    <div>
      {posts.map(post => (
        <article key={post.id}>
          <h2>{post.title.rendered}</h2>
          <p>{post.excerpt.rendered}</p>
        </article>
      ))}
    </div>
  );
}

// This function:
// - Fetches from WordPress REST API with _embed parameter
// - Caches for 1 minute (configurable in WORDPRESS_CONFIG)
// - Tags cache with 'posts-list' for on-demand revalidation
// - Automatically extracts category names from _embedded data
```

### getPostBySlug(slug)

Server-only function to fetch a single post by slug with automatic cache tagging.

```typescript
// app/[year]/[month]/[category]/[slug]/page.tsx
import { getPostBySlug } from '@/src/server/wordpress';
import { notFound } from 'next/navigation';

export default async function PostPage({
  params
}: {
  params: Promise<{ slug: string }>
}) {
  const { slug } = await params;
  const post = await getPostBySlug(slug);

  if (!post) {
    notFound();
  }

  return (
    <article>
      <h1>{post.title.rendered}</h1>
      <div dangerouslySetInnerHTML={{ __html: post.content.rendered }} />
    </article>
  );
}

// This function:
// - Tags cache with 'post-{slug}' for targeted revalidation
// - Returns null if post not found (triggers 404)
// - Includes embedded featured media and author data
// - Caches for 5 minutes with stale-while-revalidate
```

### getPostsByCategorySlug(slug, perPage, page)

Server-only function to fetch posts filtered by category slug with fuzzy matching.

```typescript
// app/categoria/[slug]/page.tsx
import { getPostsByCategorySlug } from '@/src/server/wordpress';

export default async function CategoryPage({
  params
}: {
  params: Promise<{ slug: string }>
}) {
  const { slug } = await params;
  const posts = await getPostsByCategorySlug(slug, 50, 1);

  if (posts.length === 0) {
    return <p>Nenhuma notícia encontrada nesta categoria.</p>;
  }

  return (
    <div>
      <h1>Categoria: {slug}</h1>
      {posts.map(post => (
        <article key={post.id}>
          <h2>{post.title.rendered}</h2>
        </article>
      ))}
    </div>
  );
}

// This function:
// - First tries exact slug match
// - Falls back to fuzzy search with normalized text (removes accents)
// - Returns empty array if category not found
// - Tagged with 'posts-list' for cache revalidation
```

### getPostsGroupedByCategories(perPage, page)

Optimized server-only function to fetch posts once and group by multiple categories locally.

```typescript
// app/page.tsx
import { getPostsGroupedByCategories } from '@/src/server/wordpress';

export default async function HomePage() {
  // Fetch 50 posts once, grouped by all categories (1 API call!)
  const grouped = await getPostsGroupedByCategories(50, 1);

  const noticias = grouped['noticias'] || [];
  const politica = grouped['politica'] || [];
  const esportes = grouped['esportes'] || [];

  return (
    <div>
      <section>
        <h2>Notícias</h2>
        {noticias.slice(0, 5).map(post => (
          <article key={post.id}>{post.title.rendered}</article>
        ))}
      </section>

      <section>
        <h2>Política</h2>
        {politica.slice(0, 5).map(post => (
          <article key={post.id}>{post.title.rendered}</article>
        ))}
      </section>

      <section>
        <h2>Esportes</h2>
        {esportes.slice(0, 5).map(post => (
          <article key={post.id}>{post.title.rendered}</article>
        ))}
      </section>
    </div>
  );
}

// This function:
// - Fetches posts ONCE and groups by all categories
// - Avoids duplicate API calls when posts appear in multiple categories
// - Normalizes category names (removes accents, lowercase)
// - More efficient than multiple getPostsByCategorySlug() calls
// - Returns Record<string, WordPressPost[]> mapping category slug to posts
```

## Client-Side React Hooks

### usePosts(perPage)

TanStack Query hook for fetching posts on the client with automatic caching.

```typescript
'use client';
import { usePosts } from '@/src/hooks/usePosts';

export function PostsList() {
  const { data: posts, isLoading, error } = usePosts(30);

  if (isLoading) {
    return <div>Carregando notícias...</div>;
  }

  if (error) {
    return <div>Erro ao carregar: {error.message}</div>;
  }

  return (
    <div>
      {posts?.map(post => (
        <article key={post.id}>
          <h3>{post.title.rendered}</h3>
        </article>
      ))}
    </div>
  );
}

// Features:
// - Automatic caching with TanStack Query
// - Background refetching
// - Deduplicated requests
// - Integrated with global staleTime config
```

### usePostsByCategory(slug, perPage, enabled)

TanStack Query hook for fetching category-filtered posts with conditional execution.

```typescript
'use client';
import { usePostsByCategory } from '@/src/hooks/usePosts';
import { useState } from 'react';

export function CategoryFilter() {
  const [selectedCategory, setSelectedCategory] = useState<string | null>(null);

  const { data: posts, isLoading } = usePostsByCategory(
    selectedCategory || '',
    100,
    !!selectedCategory // Only fetch when category is selected
  );

  return (
    <div>
      <select onChange={(e) => setSelectedCategory(e.target.value)}>
        <option value="">Selecione uma categoria</option>
        <option value="noticias">Notícias</option>
        <option value="esportes">Esportes</option>
      </select>

      {isLoading && <p>Carregando...</p>}
      {posts && posts.map(post => (
        <div key={post.id}>{post.title.rendered}</div>
      ))}
    </div>
  );
}
```

### useInfinitePosts(perPage)

TanStack Query infinite scroll hook with automatic pagination.

```typescript
'use client';
import { useInfinitePosts } from '@/src/hooks/usePosts';
import { useEffect } from 'react';

export function InfinitePostsList() {
  const {
    data,
    fetchNextPage,
    hasNextPage,
    isFetchingNextPage,
    isLoading
  } = useInfinitePosts(10);

  useEffect(() => {
    const handleScroll = () => {
      if (
        window.innerHeight + window.scrollY >= document.body.offsetHeight - 500 &&
        hasNextPage &&
        !isFetchingNextPage
      ) {
        fetchNextPage();
      }
    };

    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, [fetchNextPage, hasNextPage, isFetchingNextPage]);

  if (isLoading) return <div>Carregando...</div>;

  return (
    <div>
      {data?.pages.map((page, i) => (
        <div key={i}>
          {page.map(post => (
            <article key={post.id}>
              <h3>{post.title.rendered}</h3>
            </article>
          ))}
        </div>
      ))}
      {isFetchingNextPage && <div>Carregando mais...</div>}
      {!hasNextPage && <div>Fim da lista</div>}
    </div>
  );
}
```

### useInvalidatePosts()

Hook for programmatically clearing cached post data.

```typescript
'use client';
import { useInvalidatePosts } from '@/src/hooks/usePosts';

export function RefreshButton() {
  const { invalidateAllPosts, invalidateCategory } = useInvalidatePosts();

  const handleRefreshAll = () => {
    invalidateAllPosts();
    console.log('All posts cache cleared');
  };

  const handleRefreshCategory = (categorySlug: string) => {
    invalidateCategory(categorySlug);
    console.log(`Category ${categorySlug} cache cleared`);
  };

  return (
    <div>
      <button onClick={handleRefreshAll}>
        Atualizar Todas as Notícias
      </button>
      <button onClick={() => handleRefreshCategory('noticias')}>
        Atualizar Categoria Notícias
      </button>
    </div>
  );
}
```

## WordPress Webhook Integration

### WordPress functions.php Integration

Add this code to WordPress to enable automatic cache revalidation.

```php
<?php
// Add to WordPress theme functions.php

define('NEXTJS_SITE_URL', 'https://your-site.vercel.app');
define('WEBHOOK_SECRET', 'your-secure-random-token-here');

function revalidate_nextjs_cache_on_publish($new_status, $old_status, $post) {
    if ($new_status !== 'publish' || $old_status === 'publish') {
        return;
    }

    if ($post->post_type !== 'post') {
        return;
    }

    $url = NEXTJS_SITE_URL . '/api/revalidate';
    $secret = WEBHOOK_SECRET;

    // Use multi-tag revalidation (more efficient - single request)
    $tags = ['posts-list', 'post-' . $post->post_name];

    wp_remote_post($url, [
        'headers' => [
            'Authorization' => 'Bearer ' . $secret,
            'Content-Type' => 'application/json',
        ],
        'body' => json_encode([
            'tags' => $tags, // Send multiple tags at once
            'postId' => $post->ID,
            'postSlug' => $post->post_name,
        ]),
        'timeout' => 5,
        'blocking' => false,
    ]);

    error_log('Cache revalidated for: ' . $post->post_title);
}

add_action('transition_post_status', 'revalidate_nextjs_cache_on_publish', 10, 3);
add_action('post_updated', 'revalidate_nextjs_cache_on_publish', 10, 3);

// Also revalidate when categories change
function revalidate_category_cache($term_id, $tt_id, $taxonomy) {
    if ($taxonomy !== 'category') {
        return;
    }

    $term = get_term($term_id, 'category');
    if (!$term || is_wp_error($term)) {
        return;
    }

    $url = NEXTJS_SITE_URL . '/api/revalidate';
    $secret = WEBHOOK_SECRET;

    wp_remote_post($url, [
        'headers' => [
            'Authorization' => 'Bearer ' . $secret,
            'Content-Type' => 'application/json',
        ],
        'body' => json_encode([
            'tags' => ['categories', 'posts-list'],
        ]),
        'timeout' => 5,
        'blocking' => false,
    ]);

    error_log('Cache revalidated for category: ' . $term->name);
}

add_action('edited_category', 'revalidate_category_cache', 10, 3);
add_action('created_category', 'revalidate_category_cache', 10, 3);
?>
```

### Environment Configuration

Set up environment variables for WordPress integration and external APIs.

```bash
# .env.local

# WordPress API Configuration
WORDPRESS_API_URL=https://primeiranews.com.br/wp-json/wp/v2

# Webhook Secret for Cache Revalidation
WEBHOOK_SECRET=generate-a-secure-random-token-here

# Optional: Twitter API (for trending topics)
TWITTER_BEARER_TOKEN=your-twitter-bearer-token

# Optional: YouTube API (for video metadata)
YOUTUBE_API_KEY=your-youtube-api-key
```

## Configuration

### WordPress Cache Configuration

Configure cache TTL and API settings in `src/config/wordpress.ts`.

```typescript
export const WORDPRESS_CONFIG = {
  API_BASE: 'https://primeiranews.com.br/wp-json/wp/v2',
  SITE_URL: 'https://primeiranews.com.br',

  // Cache TTL configuration (in seconds)
  // Short TTL values for fast updates via webhook revalidation
  CACHE_TTL: {
    POSTS_LIST: 60,        // 1 minute - revalidated via webhook on publish
    POSTS_CATEGORY: 300,   // 5 minutes - revalidated via webhook on publish
    POST_SINGLE: 300,      // 5 minutes - revalidated via webhook on edit
    CATEGORIES: 3600,      // 1 hour (categories rarely change)
    TAGS: 3600,            // 1 hour
    MEDIA: 31536000,       // 1 year (images don't change)
  },

  PAGINATION: {
    PER_PAGE: 10,
    MAX_PAGES: 50,
  },

  FIELDS: {
    POSTS: 'id,title,excerpt,content,date,link,categories,featured_media,author',
    CATEGORIES: 'id,name,slug,count,description',
    TAGS: 'id,name,slug,count',
    MEDIA: 'id,title,media_details,source_url',
  },
};

// Usage in your code:
import { WORDPRESS_CONFIG } from '@/src/config/wordpress';

const cacheSeconds = WORDPRESS_CONFIG.CACHE_TTL.POSTS_LIST;
console.log(`Posts cached for ${cacheSeconds} seconds`);
```

### Next.js Configuration

Key Next.js settings for optimization in `next.config.mjs`.

```javascript
// next.config.mjs
import bundleAnalyzer from "@next/bundle-analyzer";

const withBundleAnalyzer = bundleAnalyzer({
  enabled: process.env.ANALYZE === "true",
});

const nextConfig = {
  // Enable component-level caching (Next.js 16 feature - PPR alternative)
  cacheComponents: true,

  // React Compiler (automatic memoization - replaces manual React.memo)
  reactCompiler: true,

  experimental: {
    // Inline CSS into HTML for faster rendering
    inlineCss: true,

    // Turbopack caching for faster builds
    turbopackFileSystemCacheForDev: true,
    turbopackFileSystemCacheForBuild: true,

    // Client-side router cache - optimized for news portal
    staleTimes: {
      dynamic: 30,    // 30s for dynamic routes (posts)
      static: 1800,   // 30min for static routes
    },

    // Optimize Server Component rendering
    optimizeServerReact: true,

    // Optimize package imports to reduce bundle size
    optimizePackageImports: [
      'lucide-react',
      'date-fns',
      'lodash',
      'lodash-es',
      'ramda',
      '@radix-ui/react-icons',
    ],
  },

  // Define explicit root directory to avoid lockfile conflicts
  turbopack: {
    root: process.cwd(),
  },

  // Image optimization settings
  images: {
    remotePatterns: [
      {
        protocol: 'https',
        hostname: 'primeiranews.com.br',
      },
      {
        protocol: 'https',
        hostname: 'primeiranewsimg.twic.pics',
      },
      {
        protocol: 'https',
        hostname: 'primeiranews.twic.pics',
      },
    ],
    formats: ['image/avif'],
    deviceSizes: [256, 640, 750, 828, 1080, 1200, 1920, 2048, 3000],
    imageSizes: [32, 48, 64, 96, 128, 256, 384],
    qualities: [80],
    minimumCacheTTL: 2678400, // 31 days
  },

  // Remove console.log in production
  compiler: {
    removeConsole: process.env.NODE_ENV === "production",
  },

  // HTTP Headers - Cache, Security and Early Hints
  async headers() {
    return [
      // API Routes - Cache disabled (webhook revalidates when needed)
      {
        source: "/api/posts/:path*",
        headers: [
          { key: "Cache-Control", value: "no-store, no-cache, must-revalidate" },
          { key: "Vercel-CDN-Cache-Control", value: "no-store" },
        ],
      },
      {
        source: "/api/revalidate",
        headers: [
          { key: "Cache-Control", value: "no-store, no-cache, must-revalidate" },
          { key: "Vercel-CDN-Cache-Control", value: "no-store" },
        ],
      },
      // Twitter API - Cache 5 minutes
      {
        source: "/api/twitter/trends",
        headers: [
          { key: "Cache-Control", value: "public, max-age=300" },
          { key: "Vercel-CDN-Cache-Control", value: "max-age=300" },
        ],
      },
      // YouTube Metadata - Cache 1 hour (CDN 24h)
      {
        source: "/api/youtube/metadata",
        headers: [
          { key: "Cache-Control", value: "public, max-age=3600" },
          { key: "Vercel-CDN-Cache-Control", value: "max-age=86400" },
        ],
      },
      // Next.js static assets - Immutable cache 1 year
      {
        source: "/_next/static/:path*",
        headers: [
          { key: "Cache-Control", value: "public, max-age=31536000, immutable" },
          { key: "Vercel-CDN-Cache-Control", value: "max-age=31536000, immutable" },
        ],
      },
      // Fonts - Immutable cache 1 year + CORS
      {
        source: "/fonts/:path*",
        headers: [
          { key: "Cache-Control", value: "public, max-age=31536000, immutable" },
          { key: "Vercel-CDN-Cache-Control", value: "max-age=31536000, immutable" },
          { key: "Access-Control-Allow-Origin", value: "*" },
        ],
      },
      // Global headers - Security + Early Hints
      {
        source: "/:path*",
        headers: [
          // Early Hints (103) - Preconnect for CDNs
          {
            key: "Link",
            value: [
              "<https://primeiranews.twic.pics>; rel=preconnect; crossorigin",
              "<https://primeiranews.com.br>; rel=preconnect"
            ].join(", "),
          },
          // Security
          { key: "X-Frame-Options", value: "SAMEORIGIN" },
          { key: "X-Content-Type-Options", value: "nosniff" },
          { key: "Referrer-Policy", value: "strict-origin-when-cross-origin" },
          { key: "X-DNS-Prefetch-Control", value: "on" },
        ],
      },
    ];
  },

  // Redirects (WordPress Admin)
  async redirects() {
    return [
      {
        source: "/wp-admin/:path*",
        destination: "https://primeiranews.com.br/wp-admin/:path*",
        permanent: false,
      },
      {
        source: "/wp-json/:path*",
        destination: "https://primeiranews.com.br/wp-json/:path*",
        permanent: false,
      },
    ];
  },
};

export default withBundleAnalyzer(nextConfig);
```

## UI Components

### ScrollReveal Component

Client-side animation component with Intersection Observer for revealing content on scroll.

```typescript
'use client';
import ScrollReveal from '@/src/components/animations/ScrollReveal';

export function AnimatedSection() {
  return (
    <ScrollReveal
      animation="fade-scale"
      delay={100}
      duration={600}
      threshold={0.1}
    >
      <div className="card">
        <h2>This content will animate when scrolled into view</h2>
      </div>
    </ScrollReveal>
  );
}

// Available animation types:
// 'fade' | 'slide-up' | 'slide-down' | 'slide-left' | 'slide-right' |
// 'scale' | 'fade-scale' | 'zoom-in' | 'blur'

// With skeleton loading
export function AnimatedWithSkeleton() {
  const { data, isLoading } = usePosts(10);

  return (
    <ScrollReveal
      animation="slide-up"
      showSkeleton={true}
      isLoading={isLoading}
      skeleton={
        <div className="animate-pulse space-y-4">
          <div className="h-8 bg-gray-200 rounded w-3/4"></div>
          <div className="h-4 bg-gray-200 rounded w-1/2"></div>
        </div>
      }
    >
      {data?.map(post => (
        <article key={post.id}>{post.title.rendered}</article>
      ))}
    </ScrollReveal>
  );
}

// Props:
// - animation: Animation type (default: 'fade')
// - delay: Animation delay in ms (default: 0)
// - duration: Animation duration in ms (default: 400)
// - threshold: IntersectionObserver threshold (default: 0.05)
// - rootMargin: Margin before triggering (default: '0px 0px 100px 0px')
// - triggerOnce: Only animate once (default: true)
// - showSkeleton: Show skeleton during loading (default: false)
// - isLoading: Loading state for skeleton (default: false)
// - skeleton: Custom skeleton component
```

## Cache Revalidation Implementation

### Server-Side Revalidation with Profile Parameter

The revalidation endpoint uses Next.js 16's updated `revalidateTag` API with profile parameter.

```typescript
import { revalidateTag } from 'next/cache';

// In app/api/revalidate/route.ts
for (const tag of tagsToRevalidate) {
  try {
    // Use 'max' profile for aggressive revalidation
    await revalidateTag(tag, 'max');

    console.log(`Cache revalidated successfully for tag: ${tag}`);
  } catch (error) {
    console.error(`Error revalidating tag ${tag}:`, error);
  }
}

// Profile options:
// - 'max': Most aggressive revalidation, best for real-time updates
// - 'balanced': Default behavior, balances performance and freshness
// - 'min': Minimal revalidation, prioritizes cache hits
```

## Summary

Primeira News is a production-ready Next.js 16.1.0 application that demonstrates cutting-edge web development practices for content-heavy sites. The platform combines WordPress's robust content management capabilities with Next.js's latest performance features including component-level caching (cacheComponents), React Compiler for automatic memoization (eliminating manual React.memo), and Turbopack for lightning-fast builds. The webhook-based cache revalidation with rate limiting and multi-tag support ensures content updates appear instantly without sacrificing the performance benefits of aggressive long-term caching strategies.

The application is ideal for news organizations, blogs, and content publishers who want the editorial experience of WordPress with the bleeding-edge performance of React 19.3 and Next.js 16.1. Key features include REST API consumption with server-side caching and revalidation tags, client-side state management with TanStack Query, real-time cache invalidation via authenticated webhooks with rate limiting, external API integrations for Twitter trends and YouTube metadata, scroll-based animations with Intersection Observer, React Compiler auto-memoization for zero-overhead optimization, and TwicPics image optimization for responsive images. The codebase follows Next.js App Router conventions with clear separation between server and client components and comprehensive type safety with TypeScript, making it maintainable and scalable for growing content needs.
